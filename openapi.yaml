openapi: 3.1.0
info:
  title: Structural Certainty API
  description: >
    Deterministic structural options bias engine.
    Provides regime, directional bias, confidence, drivers,
    and tactical execution guidance.
  version: 1.0.0

servers:
  - url: https://gpt-1-mu.vercel.app

paths:
  /api/structural-certainty/daily:
    get:
      operationId: getDailyReport
      summary: Daily structural options bias
      parameters:
        - name: symbol
          in: query
          required: true
          schema:
            type: string
            example: IWM
      responses:
        "200":
          description: Structural certainty report
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StructuralCertaintyResponse"

components:
  schemas:

    StructuralCertaintyResponse:
      type: object
      required:
        - symbol
        - regime
        - pc_ratio
        - max_pain
        - bias
        - execution
        - invalidation
      additionalProperties: false
      properties:
        symbol:
          type: string
          example: IWM

        regime:
          type: string
          enum:
            - BEAR_CONTROLLED
            - BULL_CONTROLLED
            - MIXED

        pc_ratio:
          type: string
          example: "3.68"

        max_pain:
          type: string
          example: "262.00"

        bias:
          $ref: "#/components/schemas/Bias"

        execution:
          type: string
          example: Short scalps favored; sell failed pops

        invalidation:
          type: string
          example: PC ratio normalization or ITM dominance flip

    Bias:
      type: object
      required:
        - direction
        - confidence
        - disallowed
        - drivers
      additionalProperties: false
      properties:
        direction:
          type: string
          enum:
            - SHORT_BIAS_INTRADAY
            - LONG_BIAS_INTRADAY
            - NO_TRADE

        confidence:
          type: integer
          minimum: 0
          maximum: 100
          example: 40

        disallowed:
          type: array
          items:
            type: string
            enum:
              - LONG
              - SHORT

        drivers:
          type: array
          items:
            type: string
            enum:
              - heavy_put_dominance
              - heavy_call_dominance
              - itm_put_control
              - itm_call_control
              - low_structural_conviction
